generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model user {
  id             Int              @id @default(autoincrement())
  created_at     DateTime         @default(now()) @db.Timestamptz(6)
  email          String           @unique @db.VarChar
  username       String           @unique @db.VarChar
  password       String           @db.VarChar
  points         Int?             @default(0)
  id_userImg     Int?             @default(1)
  isAdmin        Boolean          @default(false)
  userImgs       userImgs?        @relation(fields: [id_userImg], references: [id], onDelete: NoAction, onUpdate: NoAction)
  user_has_level user_has_level[]
}

model userImgs {
  id         Int      @id @default(autoincrement())
  created_at DateTime @default(now()) @db.Timestamptz(6)
  imgName    String   @db.VarChar
  user       user[]
}

model world {
  id         Int      @id @default(autoincrement())
  created_at DateTime @default(now()) @db.Timestamptz(6)
  name       String   @db.VarChar
  icon       String
  level      level[]
}

model category {
  id         Int        @id @default(autoincrement())
  created_at DateTime   @default(now()) @db.Timestamptz(6)
  name       String?    @db.VarChar
  question   question[]
}

model level {
  id                 Int                  @id @default(autoincrement())
  created_at         DateTime             @default(now()) @db.Timestamptz(6)
  number             Int
  label              String?
  id_world           Int
  world              world                @relation(fields: [id_world], references: [id], onDelete: NoAction, onUpdate: NoAction)
  level_has_question level_has_question[]
  user_has_level     user_has_level[]
}

model level_has_question {
  created_at  DateTime @default(now()) @db.Timestamptz(6)
  id_level    Int
  id_question Int
  level       level    @relation(fields: [id_level], references: [id], onDelete: NoAction, onUpdate: NoAction)
  question    question @relation(fields: [id_question], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@id([id_level, id_question])
}

model question {
  id                 Int                  @id @default(autoincrement())
  created_at         DateTime             @default(now()) @db.Timestamptz(6)
  title              String               @db.VarChar
  weight             Int                  @default(1000)
  id_category        Int                  @default(1)
  level_has_question level_has_question[]
  option             option[]
  category           category             @relation(fields: [id_category], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model user_has_level {
  id_user    Int      @default(autoincrement())
  created_at DateTime @default(now()) @db.Timestamptz(6)
  id_level   Int
  max_points Int      @default(0)
  level      level    @relation(fields: [id_level], references: [id], onDelete: NoAction, onUpdate: NoAction)
  user       user     @relation(fields: [id_user], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@id([id_user, id_level])
}

model option {
  id          Int      @id @default(autoincrement())
  created_at  DateTime @default(now()) @db.Timestamptz(6)
  label       String   @db.VarChar
  isCorrect   Boolean  @default(false)
  id_question Int
  question    question @relation(fields: [id_question], references: [id], onDelete: NoAction, onUpdate: NoAction)
}
